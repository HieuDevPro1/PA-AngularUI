<!-- Add a modal component -->
<app-modal
  *ngIf="showModal"
  [action]="modalAction"
  [product]="selectedProduct"
  (closeModal)="closeModal()"
></app-modal>

<div class="col-lg-12 grid-margin stretch-card">
  <div class="card">
    <div class="card-body">
      <h4 class="card-title">Products DataTables</h4>
      <form class="nav-link w-25">
        <div class="input-group">
          <span class="input-group-text"
            ><i class="mdi mdi-yeast icon-search"></i
          ></span>
          <input
            type="text"
            (input)="search($event)"
            class="form-control"
            placeholder="Search..."
          />
        </div>
      </form>
      <div class="svg-container">
        <svg
          data-toggle="modal"
          data-target="#exampleModal"
          (click)="openModal('add')"
          fill="#6698FF"
          width="40"
          height="40"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 448 512"
        >
          <path
            d="M64 80c-8.8 0-16 7.2-16 16V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V96c0-8.8-7.2-16-16-16H64zM0 96C0 60.7 28.7 32 64 32H384c35.3 0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96zM200 344V280H136c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H248v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"
          />
        </svg>
      </div>

      <!-- <p class="card-description"> Add class <code>.table-hover</code>
      </p> -->

      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Name</th>
              
              <th>
                Category
                <i
                  class="mdi mdi-filter-outline"
                  type="button"
                  id="dropdownMenuFilter"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                ></i>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuFilter">
                  <div class="form-group">
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="categoryOptions"
                          value=""
                          (change)="filterByCategory('')"
                        />
                        All
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="categoryOptions"
                          value="Iphone"
                          (change)="filterByCategory('Iphone')"
                        />
                        Iphone
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="categoryOptions"
                          value="Samsung"
                          (change)="filterByCategory('Samsung')"
                        />
                        Samsung
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="categoryOptions"
                          value="Xiaomi"
                          (change)="filterByCategory('Xiaomi')"
                        />
                        Xiaomi
                      </label>
                    </div>
                  </div>
                </div>
              </th>

              <th>
                Inventory
                <i
                  class="mdi mdi-filter-outline"
                  type="button"
                  id="dropdownMenuInventoryFilter"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                ></i>
                <div
                  class="dropdown-menu"
                  aria-labelledby="dropdownMenuInventoryFilter"
                >
                  <div class="form-group">
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="inventoryOptions"
                          value=""
                          (change)="filterByInventoryRange(0, maxNumberValue)"
                        />
                        All
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="inventoryOptions"
                          value="Low"
                          (change)="filterByInventoryRange(0, 25)"
                        />
                        Low (<= 25)
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="inventoryOptions"
                          value="Medium"
                          (change)="filterByInventoryRange(26, 70)"
                        />
                        Medium (26 - 70)
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="inventoryOptions"
                          value="High"
                          (change)="
                            filterByInventoryRange(71, maxNumberValue)
                          "
                        />
                        High (> 70)
                      </label>
                    </div>
                  </div>
                </div>
              </th>

              <th>
                Price
                <i
                  class="mdi mdi-filter-outline"
                  type="button"
                  id="dropdownMenuPriceFilter"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                ></i>
                <div
                  class="dropdown-menu"
                  aria-labelledby="dropdownMenuPriceFilter"
                >
                  <div class="form-group">
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="priceOptions"
                          value=""
                          (change)="filterByPriceRange(0, maxNumberValue)"
                        />
                        All
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="priceOptions"
                          value="Low"
                          (change)="filterByPriceRange(0, 10000000)"
                        />
                        Low (<= 10tr)
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="priceOptions"
                          value="Medium"
                          (change)="filterByPriceRange(10000001, 30000000)"
                        />
                        Medium (10tr - 30tr)
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="priceOptions"
                          value="High"
                          (change)="filterByPriceRange(30000001, maxNumberValue)"
                        />
                        High (> 30tr)
                      </label>
                    </div>
                  </div>
                </div>
              </th>

              <th>
                Discount
                <i
                  class="mdi mdi-filter-outline"
                  type="button"
                  id="dropdownMenuDiscountFilter"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                ></i>
                <div
                  class="dropdown-menu"
                  aria-labelledby="dropdownMenuDiscountFilter"
                >
                  <div class="form-group">
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="discountOptions"
                          value=""
                          (change)="filterByDiscountRange(0, maxNumberValue)"
                        />
                        All
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="discountOptions"
                          value="Low"
                          (change)="filterByDiscountRange(0, 10)"
                        />
                        Low (<= 10%)
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="discountOptions"
                          value="Medium"
                          (change)="filterByDiscountRange(11, 30)"
                        />
                        Medium (11% - 30%)
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="discountOptions"
                          value="High"
                          (change)="filterByDiscountRange(31, maxNumberValue)"
                        />
                        High (> 30%)
                      </label>
                    </div>
                  </div>
                </div>
              </th>

              <th>
                Sold
                <i
                  class="mdi mdi-filter-outline"
                  type="button"
                  id="dropdownMenuSoldFilter"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                ></i>
                <div
                  class="dropdown-menu"
                  aria-labelledby="dropdownMenuSoldFilter"
                >
                  <div class="form-group">
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="soldOptions"
                          value=""
                          (change)="filterBySoldRange(0, maxNumberValue)"
                        />
                        All
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="soldOptions"
                          value="Low"
                          (change)="filterBySoldRange(0, 250)"
                        />
                        Low (<= 250)
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="soldOptions"
                          value="Medium"
                          (change)="filterBySoldRange(251, 500)"
                        />
                        Medium (251 - 500)
                      </label>
                    </div>
                    <div class="form-check">
                      <label class="form-check-labell">
                        <input
                          type="radio"
                          class="form-check-radio"
                          name="soldOptions"
                          value="High"
                          (change)="filterBySoldRange(501, maxNumberValue)"
                        />
                        High (> 500)
                      </label>
                    </div>
                  </div>
                </div>
              </th>

              <th>Description</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let product of filterProductList | paginate : config">
              <td>{{ product.name }}</td>
              <td>{{ product.category }}</td>
              <td>
                {{ product.inventory }}
                <div class="progress">
                  <div
                    class="progress-bar"
                    role="progressbar"
                    [ngClass]="getProgressBarClass(product.inventory)"
                    [style.width.%]="product.inventory"
                    [attr.aria-valuenow]="product.inventory"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </td>
              <td>
                {{
                  product.price | currency : "VND" : "symbol-narrow" : "1.0-0"
                }}
              </td>
              <td>
                <div class="row">
                  <p class="text-danger mb-0 ml-4 font-weight-medium">
                    -{{ product.discount }}%
                  </p>
                </div>
              </td>
              <td [ngClass]="getSoldClassAndIcon(product.sold).class">
                {{ getSoldPercentage(product.sold).toFixed(2) }}%
                <i
                  class="mdi"
                  [ngClass]="getSoldClassAndIcon(product.sold).icon"
                ></i>
              </td>
              <td>{{ product.description }}</td>
              <td>
                <div class="row justify-content-center">
                  <svg
                    class="m-2 svg-icon"
                    data-toggle="modal"
                    data-target="#exampleModal"
                    (click)="openModal('update', product)"
                    fill="#E0EEE0"
                    width="24"
                    height="24"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 512 512"
                  >
                    <path
                      d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"
                    />
                  </svg>

                  <svg
                    class="m-2 svg-icon"
                    data-toggle="modal"
                    data-target="#deleteModal"
                    fill="#CC3333"
                    width="24"
                    height="24"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 448 512"
                  >
                    <path
                      d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"
                    />
                  </svg>
                  <!-- Delete Confirmation Modal -->
                  <div
                    class="modal fade"
                    id="deleteModal"
                    tabindex="-1"
                    role="dialog"
                    aria-labelledby="deleteModalLabel"
                    aria-hidden="true"
                  >
                    <div class="modal-dialog" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5
                            class="modal-title text-light"
                            id="deleteModalLabel"
                          >
                            Delete Confirmation
                          </h5>
                          <button
                            type="button"
                            class="close"
                            data-dismiss="modal"
                            aria-label="Close"
                          >
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body text-light">
                          Are you sure you want to delete this product?
                        </div>
                        <div class="modal-footer">
                          <button
                            type="button"
                            class="btn btn-secondary"
                            data-dismiss="modal"
                          >
                            Cancel
                          </button>
                          <button
                            type="button"
                            class="btn btn-danger"
                            data-dismiss="modal"
                            (click)="deleteProduct(product._id)"
                          >
                            Delete
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <pagination-controls
          class="pagination"
          (pageChange)="pageChanged($event)"
        ></pagination-controls>
      </div>
    </div>
  </div>
</div>
